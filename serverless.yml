service: ja-pie
# app and org for use with dashboard.serverless.com
app: pie
org: annatest

# You can pin your service to only deploy with a specific Serverless version
# Check out our docs for more details
frameworkVersion: '2'

package:
  individually: true
  exclude:
    - resources/**
    - front-end/**

provider:
  name: aws
  runtime: nodejs12.x
  lambdaHashingVersion: 20201221
  region: eu-west-1
  httpApi:
    cors: true
  iamRoleStatements:
    - Effect: Allow
      Action:
        - s3:GetObject
      Resource: arn:aws:s3:::birthday-pie-ingredients/*

functions:
  pie:
    handler: handlers/pie.pie
    events: 
      - httpApi: 'GET /random-pie'
    layers:
    # Ref name is generated by TitleCasing the layer name & appending LambdaLayer
      - {Ref: UtilsLambdaLayer}

  sport:
    handler: handlers/sport.sport
    events: 
      - httpApi: 'GET /random-sport'
    layers:
    # Ref name is generated by TitleCasing the layer name & appending LambdaLayer
      - {Ref: UtilsLambdaLayer}

layers:
  utils:
    path: layer
    compatibleRuntimes:
      - nodejs12.x
